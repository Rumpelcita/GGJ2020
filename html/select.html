<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>GGJ2020</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <!-- minify -->
  <link href="https://unpkg.com/nes.css@2.3.0/css/nes.min.css" rel="stylesheet" />
  <!-- latest -->
  <link href="https://unpkg.com/nes.css@latest/css/nes.min.css" rel="stylesheet" />
  <!-- core style only -->
  <link href="https://unpkg.com/nes.css/css/nes-core.min.css" rel="stylesheet" />

  <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
  <link rel='stylesheet' type='text/css' media='screen' href='slider.css'>

  <link href="https://fonts.googleapis.com/css?family=Press+Start+2P&display=swap" rel="stylesheet">
  <script>
    const allThreads = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
    let selectedThreads = [];
    let selectedPatch;

    const next = () => alert('selected threads ' + selectedThreads + ' and patch ' + selectedPatch);

    const checkIfReady = () => {
     const button = document.getElementById('btn-continue');
      if(selectedThreads.length === 4 && selectedPatch) {
        button.classList.remove('disabled');
        console.log('ready')
      } else {
        console.log('not ready :(')
        if (!button.classList.contains('disabled')) {
          button.classList.add('disabled');
        }
      }
      return
    }

    const find = (arr, number) => arr.find(element => element === number);
    const greyOutThreads = () => allThreads.forEach(
      (thread) => {
        if (!find(selectedThreads, thread)) {
          // console.log('greyout ' + thread)
          document.getElementById('btn-' + thread).classList.add('disabled');
        }
        return
      }
    )
    const greyInThreads = () => allThreads.forEach(
      (thread) => {
        if (!find(selectedThreads, thread)) {
          // console.log('greyin ' + thread)
          document.getElementById('btn-' + thread).classList.remove('disabled');
        }
        return
      }
    )

    const toggleSelectThread = (number) => {
      //limit ammount of threads here

      checkIfReady();
      if (selectedThreads.length < 4) {
        if (find(selectedThreads, number)) {
          document.getElementById("btn-" + number).classList.remove('active');
          const index = selectedThreads.indexOf(number);
          if (index > -1) {
            selectedThreads.splice(index, 1);
          }

          if (selectedThreads.length < 4) {
            greyInThreads();
          };

          checkIfReady();
          console.log('deselected ' + number)
          console.log('threads selected ' + selectedThreads)
        } else {
          document.getElementById("btn-" + number).classList.add('active');
          selectedThreads.push(number);

          if (selectedThreads.length == 4) {
            greyOutThreads()
          }

          checkIfReady();
          console.log('selected ' + number)
          console.log('threads selected ' + selectedThreads)
        }
      } else {
        greyOutThreads();
        if (find(selectedThreads, number)) {
          document.getElementById("btn-" + number).classList.remove('active');
          const index = selectedThreads.indexOf(number);
          if (index > -1) {
            selectedThreads.splice(index, 1);
          }

          if (selectedThreads.length < 4) {
            greyInThreads();
          };

          checkIfReady();
          console.log('deselected ' + number)
          console.log('threads selected ' + selectedThreads)
        }
      }
    }

    const toggleSelectPatch = (patch) => {
      if (!selectedPatch) {
        selectedPatch = patch;
        checkIfReady();

        if (selectedPatch) {
          document.getElementById("slider-controls").classList.add('hidden');
        }
      } else {
        selectedPatch = null;
        checkIfReady();

        if (!selectedPatch) {
          document.getElementById("slider-controls").classList.remove('hidden');
        }
      }

      console.log('selected patch ' + selectedPatch)

    }
  </script>
</head>

<body>
  <div class="main-game-container nes-container">
    <main class="select-screen">
      <header>
        <a class="nes-btn" href="index.html">&lt; back</a>
        <span class="nes-text is-success home-title">Select a patch and color threads</span>
        <button id="btn-continue" class="nes-btn disabled" onclick="next();">continue ></button>
      </header>
      <section>
        <div class="wrapper">
          <input checked type=radio name="slider" id="slide1" />
          <input type=radio name="slider" id="slide2" />
          <input type=radio name="slider" id="slide3" />
          <input type=radio name="slider" id="slide4" />
          <input type=radio name="slider" id="slide5" />

          <div class="slider-wrapper">
            <div class=inner>
              <article id="patch-1">
                <div class="info">
                  <button class="nes-btn" onclick="toggleSelectPatch('1')">Select patch</button>
                </div>
                <img src="https://placekitten.com/300/300" alt="kitten">
              </article>

              <article id="patch-2">
                <div class="info">
                  <button class="nes-btn" onclick="toggleSelectPatch('2')">Select patch</button>
                </div>
                <img src="https://placekitten.com/300/300" alt="kitten">
              </article>

              <articl id="patch-3">
                <div class="info">
                  <button class="nes-btn" onclick="toggleSelectPatch('3')">Select patch</button>
                </div>
                <img src="https://placekitten.com/300/300" alt="kitten">

                </article>

                <article id="patch-4">
                  <div class="info">
                    <button class="nes-btn" onclick="toggleSelectPatch('4')">Select patch</button>
                  </div>
                  <img src="https://placekitten.com/300/300" alt="kitten">
                </article>

                <article id="patch-5">
                  <div class="info">
                    <button class="nes-btn" onclick="toggleSelectPatch('5')">Select patch</button>
                  </div>
                  <img src="https://placekitten.com/300/300" alt="kitten">
                </article>
            </div>
            <!-- .inner -->
          </div>
          <!-- .slider-wrapper -->

          <div id="slider-controls" class="slider-prev-next-control">
            <label class="nes-btn is-primary" for=slide1></label>
            <label class="nes-btn is-primary" for=slide2></label>
            <label class="nes-btn is-primary" for=slide3></label>
            <label class="nes-btn is-primary" for=slide4></label>
            <label class="nes-btn is-primary" for=slide5></label>
          </div>
          <!-- .slider-prev-next-control -->

          <!-- <div class="slider-dot-control">
          <label for=slide1></label>
          <label for=slide2></label>
          <label for=slide3></label>
          <label for=slide4></label>
          <label for=slide5></label>
        </div> -->
          <!-- .slider-dot-control -->
        </div>

      </section>
      <footer>
        <div class="threads">
          <button id="btn-1" class="nes-btn thread is-success" onclick="toggleSelectThread('1')">1</button>
          <button id="btn-2" class="nes-btn thread is-primary" onclick="toggleSelectThread('2')">2</button>
          <button id="btn-3" class="nes-btn thread is-warning" onclick="toggleSelectThread('3')">3</button>
          <button id="btn-4" class="nes-btn thread is-error " onclick="toggleSelectThread('4')">4</button>
          <button id="btn-5" class="nes-btn thread" onclick="toggleSelectThread('5')">5</button>
          <button id="btn-6" class="nes-btn thread is-error " onclick="toggleSelectThread('6')">6</button>
          <button id="btn-7" class="nes-btn thread is-error " onclick="toggleSelectThread('7')">7</button>
          <button id="btn-8" class="nes-btn thread is-warning" onclick="toggleSelectThread('8')">8</button>
          <button id="btn-9" class="nes-btn thread is-error " onclick="toggleSelectThread('9')">9</button>
          <button id="btn-10" class="nes-btn thread" onclick="toggleSelectThread('10')">10</button>
          <button id="btn-11" class="nes-btn thread is-success" onclick="toggleSelectThread('11')">11</button>
          <button id="btn-12" class="nes-btn thread is-primary" onclick="toggleSelectThread('12')">12</button>

        </div>
      </footer>
    </main>
  </div>
</body>

</html>